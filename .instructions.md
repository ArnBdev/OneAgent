# OneAgent Canonical Instructions for VS Code Copilot

> **Authority**: This file complements and enforces `AGENTS.md` at the repository root. If any guidance conflicts, `AGENTS.md` is authoritative.

## 🚨 Zero Tolerance Policy

**All violations (major or minor) must be fixed before marking a task, PR, or release as complete. No exceptions, no deferrals, no warnings left behind.**

## Canonical System Enforcement

All Copilot/Copilot Chat actions must use canonical OneAgent systems for time, ID, memory, cache, and communication. Creating parallel systems is strictly forbidden.

### Required Canonical Patterns

```typescript
// Time
const timestamp = createUnifiedTimestamp();
// IDs
const id = createUnifiedId('operation', 'context');
// Memory
const memory = OneAgentMemory.getInstance();
// Cache
const cache = OneAgentUnifiedBackbone.getInstance().cache;
// Communication
const comms = UnifiedAgentCommunicationService.getInstance();
```

### Forbidden Patterns (Zero Tolerance)

```typescript
// ❌ Forbidden time/ID/memory/cache/comm patterns
const timestamp = new Date();
const timestamp = Date.now();
const id = Math.random().toString(36);
const cache = new Map();
const memory = new CustomMemoryClass();
const bus = new CustomEventBus();
private memory: ...
```

## PR Reviewer Checklist (Strict)

- [ ] No forbidden patterns (see above) anywhere in the diff
- [ ] All new files using time/ID/memory/cache/comm import canonical utilities
- [ ] All agents extend `BaseAgent` and implement `ISpecializedAgent`
- [ ] No warnings or errors in TypeScript or ESLint
- [ ] All tests for canonical compliance pass
- [ ] CHANGELOG, ROADMAP, and API_REFERENCE updated if relevant
- [ ] AGENTS.md referenced for any new architectural pattern

## Green-Before-Done

- Never mark a task or PR complete with any known violation or warning. All must be fixed before completion.

## No Deferred Violations

- All violations must be fixed before closing a task, PR, or release. No exceptions.

## Reference

- Always reference AGENTS.md as the single source of truth for canonical systems and anti-parallel protocol.

## Available Personas (Custom Chat Modes)

All persona files are in `.github/chatmodes/`:

- **oneagent-dev.chatmode.md**: Constitutional AI TypeScript Development (DevAgent/James)
- **oneagent-architect.chatmode.md**: Anti-Parallel System Architecture (Architect)
- **oneagent-planner.chatmode.md**: Strategic Planning & BMAD Framework (PlannerAgent/Alex)
- **oneagent-triage.chatmode.md**: Intelligent Task Routing & System Health (TriageAgent/Morgan)
- **oneagent-validation.chatmode.md**: Quality Validation & Constitutional AI (ValidationAgent/Quinn)
- **constitutional-ai-specialist.chatmode.md**: Ethical Development & Quality Assurance

Use `/` followed by the persona name in chat to activate a specific mode.

## Development Standards

- **Minimum Quality Score**: 80% (Grade A)
- **Constitutional AI Compliance**: 100%
- **TypeScript**: Strict typing with comprehensive error handling
- **Documentation**: Self-documenting code with clear reasoning

## Architecture Principles

- **Single Source of Truth**: UnifiedBackboneService for all operations
- **Expand Before Create**: Always enhance existing systems
- **Complete Features**: Don't remove incomplete features, complete them
- **Memory-First**: Use oneagent_memory_search before implementing
- **Quality Validation**: Apply Constitutional AI for critical decisions

## Workflow

1. **Verify (type + lint)**: `npm run verify` must pass before completion
2. **Runtime check**: `npm run verify:runtime` for smoke tests
3. **Green-before-done**: Never end with a failing build

---

For complete architectural guidance, canonical systems reference, and governance, see `AGENTS.md` at the repository root.
