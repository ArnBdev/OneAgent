# OneAgent v4.2.2 Professional — Release Notes

## Highlights

- Mission metrics export documented and validated (Prometheus gauges derived from mission registry; no parallel counters)
- Unified cache policy enforced across the platform; discovery backed by unified cache with TTL/backoff and delta events
- Web findings migrated to unified cache with write-through, per-item TTL, and negative caching for empty results
- Docs, Dev chatmode, and architecture aligned with canonical cache policy and environment flags

## Details

### Observability
- Prometheus mission gauges: active, completed, cancelled, errors, total, avgDurationMs, error_rate
- `anomaly_alert` details enriched with mission snapshot context

### Canonical Cache & Discovery
- Single cache: `OneAgentUnifiedBackbone.getInstance().cache` for all cross-cutting caches
- Discovery uses unified cache with TTL/backoff
  - `ONEAGENT_DISCOVERY_TTL_MS` (found)
  - `ONEAGENT_DISCOVERY_TTL_EMPTY_MS` (empty)
- Emits `discovery_delta` when topology changes; comm log level env-tunable
- Cache health rolled into `/health` via canonical monitoring service

### Web Findings
- Write-through to unified cache with per-item TTL
- Deterministic keys for ids/queries/urls
- Negative caching for no-result queries (`ONEAGENT_WEBFINDINGS_NEG_TTL_MS`)
- Optional local in-process maps are transient-only and can be disabled via `ONEAGENT_WEBFINDINGS_DISABLE_LOCAL_CACHE=1`

### Tooling & Docs
- Dev chatmode and `AGENTS.md` updated to reinforce single-cache policy
- Architecture doc expanded (discovery caching/backoff, thresholds, signals/logging, unified cache health, negative caching)

### Lint Guardrails (Static Enforcement)
- Custom ESLint rules added:
  - `oneagent/no-parallel-cache` — disallow long-lived Map()-based caches; use unified cache
  - `oneagent/prefer-unified-time` — prefer `createUnifiedTimestamp()`
  - `oneagent/prefer-unified-id` — prefer `createUnifiedId()`
- Transitional note for 4.2.2: `no-parallel-cache` is WARN temporarily while migrating remaining modules; will return to ERROR in the next version

### Integrity
- No parallel time/ID/cache/memory/metrics systems introduced
- Discovery and web findings route exclusively through the unified cache
- Health/metrics derived from canonical services only

---

To upgrade: pull v4.2.2 and run the standard verify.

```
npm run verify
npm run verify:runtime
```

If you publish from GitHub Releases, select tag `v4.2.2`, set the title to "OneAgent v4.2.2 Professional", and paste these notes.
